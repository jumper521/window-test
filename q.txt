import boto3
import time

# AWS リージョンと RDS クラスターの名前を指定
aws_region = 'YourAWSRegion'
cluster_identifier = 'YourRDSClusterIdentifier'

# Boto3 RDS クライアントを作成
rds_client = boto3.client('rds', region_name=aws_region)

def check_cluster_status(cluster_identifier):
    while True:
        # RDS クラスターの現在の状態を取得
        response = rds_client.describe_db_clusters(DBClusterIdentifier=cluster_identifier)
        cluster_status = response['DBClusters'][0]['Status']

        if cluster_status == 'available':
            print('RDS Cluster is running and available.')
            break

        print(f'RDS Cluster status: {cluster_status}. Waiting for it to become available...')
        time.sleep(30)  # 30秒ごとに確認

def lambda_handler(event, context):
    # RDS クラスターの状態を確認
    check_cluster_status(cluster_identifier)

    return {
        'statusCode': 200,
        'body': 'Lambda function executed successfully!'
    }
