import boto3

def disable_all_cloudwatch_alarms(event, context):
    # Lambda関数が使用するIAMロールには、必要なCloudWatchアラームの無効化権限を付与してください。
    # このIAMロールはLambda関数を実行する際に使用されます。

    region_name = 'us-east-1'  # アラームのリージョンを指定
    aws_session = boto3.Session(region_name=region_name)

    # AWSセッションを使用してCloudWatchクライアントを作成
    cloudwatch = aws_session.client('cloudwatch')

    try:
        # すべてのCloudWatchアラームのアクションを無効にする
        alarms = cloudwatch.describe_alarms()
        alarm_names = [alarm['AlarmName'] for alarm in alarms['MetricAlarms']]
        cloudwatch.disable_alarm_actions(AlarmNames=alarm_names)
        print(f"{len(alarm_names)} 個のCloudWatchアラームを無効にしました。")
    except Exception as e:
        print(f"CloudWatchアラームの無効化中にエラーが発生しました: {str(e)}")

if __name__ == '__main__':
    disable_all_cloudwatch_alarms(None, None)
