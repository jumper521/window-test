import psycopg2
import os

def lambda_handler(event, context):
    # RDS PostgreSQL 接続情報
    db_host = 'your-db-hostname'
    db_port = 'your-db-port'
    db_name = 'your-db-name'
    db_user = 'your-db-username'
    db_password = 'your-db-password'

    # PostgreSQL データベース接続
    try:
        conn = psycopg2.connect(
            host=db_host,
            port=db_port,
            dbname=db_name,
            user=db_user,
            password=db_password
        )
        print("Connected to PostgreSQL")

        # ALTER コマンドを含む SQL クエリ
        alter_queries = [
            "ALTER TABLE your_table_name ADD COLUMN new_column_name INT;",
            "ALTER TABLE your_table_name DROP COLUMN column_to_drop_name;",
            # 他の ALTER コマンドを追加
        ]

        # ALTER コマンドを実行
        with conn.cursor() as cursor:
            for query in alter_queries:
                cursor.execute(query)
                conn.commit()
                print(f"Executed ALTER query: {query}")

        conn.close()
        return {
            'statusCode': 200,
            'body': 'ALTER commands executed successfully!'
        }
    except Exception as e:
        print(f"Error: {str(e)}")
        return {
            'statusCode': 500,
            'body': f'Error: {str(e)}'
        }
